# تحديثات النظام - 29 أغسطس 2025

## المشاكل التي تم حلها:

### 1. مشكلة أرقام الهواتف في الرسائل الجماعية
**المشكلة:** كان النظام يقول "لا توجد أقساط لهذا الرقم"
**الحل:** تم إصلاح استعلام قاعدة البيانات وإضافة دعم لحقل `whatsapp_number` منفصل
**النتيجة:** الآن يمكن إرسال الرسائل الجماعية بنجاح للعملاء الذين لديهم أرقام هاتف

### 2. إضافة إمكانية حذف الأقساط
**الميزة الجديدة:** زر حذف لكل قسط مع حوار تأكيد
**الحماية:** حذف تلقائي لجميع المدفوعات المرتبطة + تحذير واضح
**الأمان:** تأكيد مزدوج قبل الحذف النهائي

### 3. إضافة دعم اللغة الكردية السورانية
**الميزة الجديدة:** دعم كامل للغتين العربية والكردية السورانية
**الميزات:**
- اختيار اللغة من الشريط الجانبي
- ترجمة جميع النصوص والرسائل
- رسائل WhatsApp مترجمة بالكردية
- حفظ تفضيل اللغة في المتصفح

## التغييرات التقنية:

### ملفات تم إنشاؤها:
1. `src/lib/translations.ts` - نظام الترجمة
2. `src/hooks/use-language.ts` - Hook لإدارة اللغة
3. `src/contexts/LanguageContext.tsx` - Context للغة
4. `supabase/migrations/20250829_add_language_support.sql` - إعدادات اللغة في قاعدة البيانات
5. `supabase/migrations/20250829_add_whatsapp_fields.sql` - حقول WhatsApp

### ملفات تم تحديثها:
1. `src/App.tsx` - إضافة LanguageProvider
2. `src/components/Layout.tsx` - اختيار اللغة وترجمة النصوص
3. `src/pages/WhatsAppReminders.tsx` - رسائل مترجمة
4. `src/pages/Installments.tsx` - ترجمة النصوص
5. `src/pages/Settings.tsx` - إعدادات اللغة

## كيفية استخدام الميزات الجديدة:

### اختيار اللغة:
1. في الشريط الجانبي العلوي، اضغط على أيقونة العالم 🌐
2. اختر اللغة المطلوبة (العربية أو الكردية)
3. سيتم حفظ التفضيل تلقائياً

### رسائل WhatsApp بالكردية:
```
سڵاو ئەحمەد محمد علي،

بیرهێنانەوەی پارەدان بۆ قیست:

📱 بەرهەم: ثلاجة موندو
💰 بڕ: 125,000 د.ع
📅 ڕێکەوتی دەستپێکردن: 29/08/2025
⏰ ماوە: 0 ڕۆژ

تکایە پارەکە لە کاتی دیاریکراو بدە.

سوپاس بۆ هاوکاریتان.
```

### حذف الأقساط:
1. اذهب إلى صفحة "إدارة الأقساط"
2. اضغط على زر "حذف" بجانب القسط المطلوب
3. اقرأ التفاصيل في حوار التأكيد
4. اضغط "حذف نهائياً" للتأكيد

## ملاحظات مهمة:
- الحذف نهائي ولا يمكن التراجع عنه
- تأكد من عمل نسخة احتياطية من البيانات قبل الحذف
- أرقام WhatsApp يمكن أن تكون مختلفة عن أرقام الهواتف العادية
- النظام يدعم الآن إرسال رسائل للأقساط التي لها أرقام WhatsApp صالحة
- اللغة تُحفظ في localStorage وتُطبق على جميع أجزاء التطبيق

## اللغات المدعومة:
- **العربية (ar)**: اللغة الافتراضية
- **الكردية السورانية (ku)**: دعم كامل للنصوص والرسائل

النظام الآن يدعم اللغتين بالكامل ويمكن إرسال الرسائل الجماعية والحذف الآمن للأقساط! 🎉
